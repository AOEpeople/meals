name: CI

# Controls when the action will run. 
on: [ pull_request, workflow_dispatch ]

jobs:
  phpmd:
    name: PHPMD
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Setup PHP environment
        uses: shivammathur/setup-php@v2
        with:
          coverage: none
          tools: phpmd
      - name: Remap paths in baseline
        run: sed -i "s#file=\"#file=\"$(pwd)/#g" app/config/commons/development/phpmd.baseline.xml
      - name: Debug Baseline
        run: cat app/config/commons/development/phpmd.baseline.xml
      - name: Run PHPMD
        run: phpmd src text ./app/config/commons/development/phpmd.xml --baseline-file ./app/config/commons/development/phpmd.baseline.xml
